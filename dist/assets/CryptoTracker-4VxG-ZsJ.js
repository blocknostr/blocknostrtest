import{j as e,a1 as I,aU as E,B as n,a7 as A,a2 as R,a3 as $,a4 as F,L as T,J as O,ak as P}from"./ui-components-D19htCb-.js";import{r as a}from"./react-vendor-CGP8wbrH.js";import{S as j,g as z}from"./index-BGaQT7BP.js";import{h as U}from"./chat-components-DAHRyOgE.js";import{t as i}from"./nostr-core-BIQxQw3C.js";const N="blocknoster_watched_coins",_=["bitcoin","alephium","ergo"],Y=()=>{const[m,v]=a.useState([]),[c,x]=a.useState(!0),[h,u]=a.useState(null),[p,C]=a.useState(null),[l,g]=a.useState(""),[r,d]=a.useState(_),[k,f]=a.useState(!1);a.useEffect(()=>{const s=localStorage.getItem(N);if(s)try{const t=JSON.parse(s);Array.isArray(t)&&t.length>0&&d(t)}catch(t){console.error("Error parsing stored coins:",t)}},[]),a.useEffect(()=>{r.length>0&&localStorage.setItem(N,JSON.stringify(r))},[r]);const o=async()=>{try{x(!0),u(null);const s=await z(r);v(s),C(new Date)}catch(s){console.error("Error fetching crypto data:",s),u("Failed to load price data")}finally{x(!1)}};a.useEffect(()=>{o();const s=setInterval(o,2*60*1e3);return()=>clearInterval(s)},[r]);const y=s=>s>=1e3?`$${s.toLocaleString(void 0,{maximumFractionDigits:0})}`:s>=1?`$${s.toLocaleString(void 0,{maximumFractionDigits:2})}`:`$${s.toLocaleString(void 0,{maximumFractionDigits:4})}`,w=s=>{const t=s>=0;return e.jsxs("span",{className:`${t?"text-green-500":"text-red-500"} text-sm`,children:[t?"+":"",s.toFixed(2),"%"]})},S=()=>{if(!l.trim()){i.error("Please enter a valid coin ID");return}const s=l.trim().toLowerCase();if(r.includes(s)){i.error("This coin is already being tracked");return}d(t=>[...t,s]),g(""),f(!1),i.success(`Added ${s} to tracked coins`)},D=s=>{if(r.length<=1){i.error("You must track at least one coin");return}d(t=>t.filter(b=>b!==s)),i.success(`Removed ${s} from tracked coins`)},L=s=>e.jsxs("div",{className:"flex items-center justify-between py-1 hover:bg-accent/30 group px-1 rounded",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"text-sm bg-muted px-1 rounded",children:["#",s.marketCapRank]}),e.jsx("div",{className:"text-sm font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-muted-foreground uppercase",children:s.symbol})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:y(s.price)}),w(s.priceChange24h),e.jsxs(n,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>D(s.id),title:"Remove from tracking",children:[e.jsx("span",{className:"sr-only",children:"Remove"}),"Ã—"]})]})]},s.id);return e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"h-3.5 w-3.5 text-primary",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M15 9.354C14.3802 8.7343 13.5233 8.39405 12.6361 8.4156C11.7489 8.43715 10.9075 8.8178 10.3179 9.46729C9.72833 10.1168 9.44338 10.9797 9.53398 11.8509C9.62457 12.722 10.08 13.5164 10.784 14.046L13.2 16L15.616 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("h3",{className:"font-medium text-sm",children:"Market Prices"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(I,{open:k,onOpenChange:f,children:[e.jsx(E,{asChild:!0,children:e.jsxs(n,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",title:"Add coin",children:[e.jsx(A,{className:"h-3 w-3"}),e.jsx("span",{className:"sr-only",children:"Add coin"})]})}),e.jsxs(R,{className:"sm:max-w-[425px]",children:[e.jsx($,{children:e.jsx(F,{children:"Add cryptocurrency"})}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"coinId",className:"text-sm",children:"Coin ID (from CoinGecko)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{id:"coinId",value:l,onChange:s=>g(s.target.value),placeholder:"e.g. bitcoin, ethereum",className:"flex-1"}),e.jsx(n,{onClick:S,children:"Add"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the CoinGecko ID of the cryptocurrency you want to track"})]})})]})]}),e.jsxs(n,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",disabled:c,onClick:o,title:"Refresh prices",children:[c?e.jsx(T,{className:"h-3 w-3 animate-spin"}):e.jsx(O,{className:"h-3 w-3"}),e.jsx("span",{className:"sr-only",children:"Refresh prices"})]})]})]}),h?e.jsxs("div",{className:"p-2 text-center text-sm text-muted-foreground bg-accent/20 rounded",children:[h,". ",e.jsx(n,{variant:"link",size:"sm",className:"p-0 h-auto text-sm",onClick:o,children:"Try again"})]}):c&&m.length===0?e.jsx("div",{className:"space-y-1",children:[1,2,3].map(s=>e.jsx("div",{className:"py-1 px-1",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(j,{className:"h-4 w-16"}),e.jsx(j,{className:"h-4 w-12"})]})},s))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-0",children:m.map(L)}),p&&e.jsx("div",{className:"mt-1 text-sm text-center text-muted-foreground",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("span",{children:["Updated ",p.toLocaleTimeString()]}),e.jsxs("a",{href:"https://www.coingecko.com/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center ml-1 text-primary hover:underline",children:["CoinGecko",e.jsx(P,{className:"h-3 w-3 ml-0.5"})]})]})})]})]})};export{Y as default};
